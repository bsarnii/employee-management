<div class="wrapper">
    <button (click)="addRow()" class="button-add">+ Add Row</button>
    @if(formArray.controls.length > 0){
        <form [formGroup]="form">
            <table>
                <thead>
                    <th>Search</th>
                    <th>Employee Name</th>
                    <th>Employee Id</th>
                    <th>Type A Amount</th>
                    <th>Type B Amount</th>
                </thead>
                <tbody>
                    @for(row of form.controls['employees'].controls;let i = $index; track i){
                        <tr class="row" [class.odd]="$odd" [formGroup]="row">
                            <td class="input-overlay-wrapper">
                                <input
                                    formControlName="search"
                                    autocomplete="off"
                                    [value]="row.controls['search'].value"
                                    (click)="overlay.results = filterResults($event)"
                                    (keyup)="overlay.results = filterResults($event)"
                                    class="search-input" 
                                    [id]="'employee_search'+i" 
                                    type="text" 
                                    placeholder="Employee name or id">
                                <app-search-results-overlay
                                    #overlay
                                    (employeeSelected)="onEmployeeSelect($event, i)" 
                                    class="overlay" 
                                /> 
                            </td>
                            <td>
                                <input readonly [value]="row.controls['employee_name'].value" type="text"placeholder="Auto filled on selection">
                            </td>
                            <td>
                                <input readonly [value]="row.controls['employee_id'].value" type="text"placeholder="Auto filled on selection">
                            </td>
                            <td>
                                <input formControlName="TypeA_Amount" min="0" type="number" [id]="'type_a_amount'+i">
                            </td>
                            <td>
                                <input formControlName="TypeB_Amount" min="0" type="number" [id]="'type_b_amount'+i">
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
            <button (click)="submit()" type="submit">Submit</button>
        </form>
    }
</div>
